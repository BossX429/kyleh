# Security Policies for Autonomous Agent

# Repository visibility
repository:
  visibility: "private"
  enforce_private: true
  allow_public_fork: false
  alert_on_visibility_change: true

# Branch protection
branches:
  main:
    require_pull_request: true
    require_approvals: 1
    dismiss_stale_reviews: true
    require_code_owner_review: true
    require_status_checks: true
    require_up_to_date: true
    required_checks:
      - "python-ci"
      - "pylint"
      - "security-scan"
    enforce_admins: false
    allow_force_push: false
    allow_deletions: false

# Secret scanning
secrets:
  enabled: true
  block_on_push: true
  scan_patterns:
    - name: "AWS Access Key"
      pattern: "AKIA[0-9A-Z]{16}"
      severity: "critical"
    - name: "Generic API Key"
      pattern: "api[_-]?key[\\s:=]+['\"]?[a-zA-Z0-9]{32,}['\"]?"
      severity: "high"
    - name: "Generic Secret"
      pattern: "secret[\\s:=]+['\"]?[a-zA-Z0-9]{20,}['\"]?"
      severity: "high"
    - name: "Private Key"
      pattern: "-----BEGIN (RSA |EC )?PRIVATE KEY-----"
      severity: "critical"
    - name: "Password"
      pattern: "password[\\s:=]+['\"]?[^'\"\\s]{8,}['\"]?"
      severity: "high"
    - name: "OAuth Token"
      pattern: "oauth[_-]?token[\\s:=]+['\"]?[a-zA-Z0-9]{20,}['\"]?"
      severity: "high"

# Dependency scanning
dependencies:
  enabled: true
  auto_fix_vulnerabilities: true
  severity_threshold: "medium"
  block_on_critical: true
  allowed_ecosystems:
    - "pip"
    - "npm"
  vulnerability_alerts:
    critical: "immediate"
    high: "24h"
    medium: "7d"
    low: "30d"

# Code scanning (SAST)
code_scanning:
  enabled: true
  tools:
    - codeql
    - bandit
  languages:
    - python
    - javascript
  scan_on:
    - push
    - pull_request
    - schedule  # Weekly
  alert_thresholds:
    error: 0
    warning: 5
    note: 10

# Allowed dependencies
allowed_dependencies:
  python:
    # Core dependencies
    - psutil
    - wmi
    - typing-extensions
    # Dev dependencies
    - black
    - isort
    - mypy
    - pytest
    - pytest-cov
  blocklist:
    - eval
    - exec
    - pickle  # Use json instead

# File restrictions
file_restrictions:
  # Never allow these file types
  blocked_extensions:
    - ".exe"
    - ".dll"
    - ".so"
    - ".dylib"
    - ".bin"
  # Sensitive files that require review
  sensitive_files:
    - "**/.env"
    - "**/.env.*"
    - "**/secrets.yml"
    - "**/credentials.json"
    - "**/config/production.yml"
  # Protected paths
  protected_paths:
    - ".github/workflows/"
    - "security_bot/"
    - "SecurityBot/"

# Compliance requirements
compliance:
  # License compliance
  licenses:
    allowed:
      - MIT
      - Apache-2.0
      - BSD-2-Clause
      - BSD-3-Clause
      - ISC
      - Python-2.0
    blocked:
      - GPL-3.0
      - AGPL-3.0
      - LGPL-3.0
  
  # Data privacy
  privacy:
    scan_for_pii: true
    pii_patterns:
      - email_addresses
      - phone_numbers
      - social_security_numbers
      - credit_card_numbers
    alert_on_pii: true

# Security review requirements
review_requirements:
  # Always require human review for these changes
  critical_files:
    - "**/auth*.py"
    - "**/security*.py"
    - "**/*encryption*.py"
    - "**/*credential*.py"
  
  critical_changes:
    - type: "authentication"
      require_review: true
      min_approvals: 2
    - type: "authorization"
      require_review: true
      min_approvals: 2
    - type: "encryption"
      require_review: true
      min_approvals: 2
    - type: "api_endpoint"
      require_review: true
      min_approvals: 1
    - type: "database_schema"
      require_review: true
      min_approvals: 2

# Access control
access_control:
  # Repository permissions
  default_permission: "read"
  
  # Team permissions
  teams:
    maintainers:
      permission: "admin"
    contributors:
      permission: "write"
    readers:
      permission: "read"
  
  # Deployment permissions
  deployments:
    require_reviewers: true
    environment_protection_rules:
      production:
        required_reviewers: 2
        wait_timer: 30  # minutes

# Incident response
incident_response:
  # Auto-response actions
  on_secret_detected:
    - revoke_secret
    - notify_security_team
    - create_incident_issue
    - block_commit
  
  on_vulnerability_detected:
    - create_security_advisory
    - notify_maintainers
    - auto_create_patch_pr  # If patch available
  
  on_unauthorized_access:
    - log_incident
    - notify_admins
    - revoke_permissions
  
  # Escalation
  escalation:
    critical: "@BossX429"
    high: "@BossX429"
    medium: "security-team"
    low: "log-only"

# Audit logging
audit:
  enabled: true
  log_events:
    - push
    - pull_request
    - deployment
    - permission_change
    - secret_access
    - security_alert
  retention_days: 365
  export_format: "json"

# Network security
network:
  allowed_domains:
    - "github.com"
    - "api.github.com"
    - "pypi.org"
    - "files.pythonhosted.org"
  blocked_ips:
    - "0.0.0.0/8"
    - "127.0.0.0/8"
  require_https: true

# Notifications
notifications:
  security_alerts:
    channels:
      - github_security_advisories
      - email
    recipients:
      - "@BossX429"
  
  policy_violations:
    immediate_notify: true
    create_issue: true
    block_action: true
